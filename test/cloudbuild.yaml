steps:

  # Write a file to persist data between steps
  - id: write
    name: bash
    script: |
      #!/usr/bin/env bash
      echo "test" > ./test.txt

  # Read the file from Step 1 as an input into container image that does not have shell
  - id: read1
    name: anchore/syft
    waitFor:
    - write
    args:
    - -o=spdx-json
    - -s=AllLayers
    - --file=./report.json
    - $(cat ./test.txt)

  - id: read2
    name: anchore/syft
    waitFor:
    - write
    env:
    - _DIGEST=$(cat ./test.txt)
    args:
    - -o=spdx-json
    - -s=AllLayers
    - --file=./report.json
    - ${_DIGEST}
